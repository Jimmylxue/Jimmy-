(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{502:function(n,s,a){"use strict";a.r(s);var e=a(4),t=Object(e.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"虚拟-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟-dom"}},[n._v("#")]),n._v(" 虚拟 DOM")]),n._v(" "),a("p",[n._v("虚拟 dom 是有 react 首创的，但是其实是可以独立存在的。虚拟 dom 这个概念也是一直都很火热")]),n._v(" "),a("ul",[a("li",[a("p",[n._v("什么是虚拟 dom")]),n._v(" "),a("p",[n._v("虚拟 dom 我们可以简单的理解成就是我们用自己的 JS 代码来表示的一个 dom 元素。而不是用浏览器的原生 dom 来表示")])]),n._v(" "),a("li",[a("p",[n._v("为什么要使用虚拟 dom")]),n._v(" "),a("p",[n._v("因为浏览器本身的原生 dom 是非常非常庞大的一个数据，如果直接使用浏览器的原生 dom 来操作的话，会消耗我们宝贵的资源性能。")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("  let div = document.createElement('div')\n  let str = ''\n  for (let key in div) {\n    str = str + key + '__'\n  }\n  console.log(str)\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200822234149562.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NjI0MDE2Mg==,size_16,color_FFFFFF,t_70#pic_center",alt:"一个空的原生DOM的数据量"}})]),n._v(" "),a("p",[n._v("可见，一个空的原生 DOM 数据量这么大，在遍历属性等等的时候就会遍历到很多无用的一些数据吗，造成资源极大的浪费，所以就需要使用轻量级的虚拟 DOM")])])]),n._v(" "),a("h2",{attrs:{id:"虚拟-dom-的基本数据结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟-dom-的基本数据结构"}},[n._v("#")]),n._v(" 虚拟 DOM 的基本数据结构")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("  {\n    tag:'div',\n    data:{\n      id:'app'\n    },\n    children:[\n      {\n        tag:'p',\n        data:{\n          class:'p1'\n        },\n        children:'hello'\n      }，\n      {\n        tag:'p',\n        data:{\n          class:'p2',\n          style:{\n            color:'red'\n          }\n        },\n        children:'world'\n      }\n    ]\n  }\n\n  // 以上我们用代码表示dom就可以映射在html上为\n  <div id=\"app\">\n    <p class=\"p1\">hello</p>\n    <p class=\"p2\">world</p>\n  </div>\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br")])]),a("p",[n._v("当我们用自己的代码来表示一个 dom 的时候，和原生的 DOM 庞大的数据量相比，就是一个非常非常轻量级和迷你的数据了，所以在操作的时候可以极大的提高性能。")]),n._v(" "),a("h3",{attrs:{id:"虚拟-dom-要有的功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟-dom-要有的功能"}},[n._v("#")]),n._v(" 虚拟 DOM 要有的功能")]),n._v(" "),a("p",[n._v("虚拟 dom 要有的基本功能和原生 dom 基本是一样的，我们就得写一套代码，让虚拟 dom 能够添加数据，对比数据，以及渲染的功能。")]),n._v(" "),a("h2",{attrs:{id:"代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[n._v("#")]),n._v(" 代码")]),n._v(" "),a("p",[n._v("代码已经上传一遍在仓库了，在"),a("a",{attrs:{href:"https://gitee.com/jimmyxuexue/front_end_architecture/tree/master/%E8%99%9A%E6%8B%9FDOM",target:"_blank",rel:"noopener noreferrer"}},[n._v("这里"),a("OutboundLink")],1)]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("const VnodeType = {\nHTML: 'HTML',\nTEXT: 'TEXT',\nCOMPONENT: 'COMPONENT',\n}\n\nconst childFlag = {\n  EMPTY: 'EMPTY',\n  SINGLE: 'SINGLE',\n  MULTIPE: 'MULTIPE',\n}\n\nfunction createElement(tag, data, childen = null) {\n  let flag\n  let childrenFlag\n  if (typeof tag == 'string') {\n    // 普通的HTML标签\n    flag = VnodeType.HTML\n  } else if (typeof tag == 'function') {\n    flag = VnodeType.COMPONENT\n  } else {\n    flag = VnodeType.TEXT\n  }\n\n  if (childen == null) {\n    childrenFlag = childFlag.EMPTY\n  } else if (Array.isArray(childen)) {\n    let length = childen.length\n    if (length == 0) {\n      childrenFlag = childFlag.EMPTY\n    } else {\n      childrenFlag = childFlag.MULTIPE\n    }\n  } else {\n    // 文本  文本也是单个元素\n    childrenFlag = childFlag.SINGLE\n    childen = createTextVnode(childen + '')\n  }\n  // 返回Vnode\n  return {\n    flag, // vnode 的类型\n    tag, // 标签，div  文本就没有tag  组件就是一个函数\n    data,\n    childen,\n    childrenFlag, // children的类型\n    el: null,\n  }\n}\n\n// 新建文本类型的vnode\nfunction createTextVnode(texts) {\n  // 返回文本标签的内容\n  return {\n    flag: VnodeType.TEXT,\n    tag: null,\n    data: null,\n    childen: texts,\n    childenFlag: childFlag.EMPTY, //  文本类型的子元素是空的\n  }\n}\n\n// 渲染函数  需要传递  要渲染的虚拟DOM 以及容器（父元素）\nfunction render(vnode, container) {\n  // 区分首次渲染和再次渲染\n  mount(vnode, container)\n}\n\n// 首次渲染\nfunction mount(vnode, container) {\n  let { flag } = vnode //  通过解构赋值 先获取虚拟DOM的类型\n  if (flag == VnodeType.HTML) {\n    mountElement(vnode, container)\n  } else if (flag == VnodeType.TEXT) {\n    mountText(vnode, container)\n  }\n}\n\nfunction mountElement(vnode, container) {\n  let dom = document.createElement(vnode.tag)\n  vnode.el = dom\n  // let data = vnode.data // 属性\n\n  let { data, childen, childrenFlag } = vnode\n  // 挂载data属性\n  if (data) {\n    for (let key in data) {\n      // 分别是 dom元素 键名称  初始值 新值\n      patchData(dom, key, null, data[key])\n    }\n  }\n\n  if (childrenFlag != childFlag.EMPTY) {\n    if (childrenFlag == childFlag.SINGLE) {\n      // 文本\n      mount(childen, dom)\n    } else if (childrenFlag == childFlag.MULTIPE) {\n      for (let i = 0; i < childen.length; i++) {\n        mount(childen[i], dom)\n      }\n    }\n  }\n\n  container.appendChild(dom)\n}\n\nfunction mountText(vnode, container) {\n  let dom = document.createTextNode(vnode.childen)\n  vnode.el = dom\n  container.appendChild(dom)\n}\n\nfunction patchData(dom, key, before, now) {\n  switch (key) {\n    case 'style':\n      for (const key in now) {\n        dom.style[key] = now[key]\n      }\n      break\n    case 'class':\n      dom.classList.add(now)\n      break\n    default:\n      if (key[0] == '@') {\n        // 点击事件的处理\n        if (now) {\n          dom.addEventListener(key.slice(1), now)\n        }\n      } else {\n        // 直接在dom上以键值对的形式添加属性\n        dom.setAttribute(key, now)\n      }\n  }\n}\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br"),a("span",{staticClass:"line-number"},[n._v("65")]),a("br"),a("span",{staticClass:"line-number"},[n._v("66")]),a("br"),a("span",{staticClass:"line-number"},[n._v("67")]),a("br"),a("span",{staticClass:"line-number"},[n._v("68")]),a("br"),a("span",{staticClass:"line-number"},[n._v("69")]),a("br"),a("span",{staticClass:"line-number"},[n._v("70")]),a("br"),a("span",{staticClass:"line-number"},[n._v("71")]),a("br"),a("span",{staticClass:"line-number"},[n._v("72")]),a("br"),a("span",{staticClass:"line-number"},[n._v("73")]),a("br"),a("span",{staticClass:"line-number"},[n._v("74")]),a("br"),a("span",{staticClass:"line-number"},[n._v("75")]),a("br"),a("span",{staticClass:"line-number"},[n._v("76")]),a("br"),a("span",{staticClass:"line-number"},[n._v("77")]),a("br"),a("span",{staticClass:"line-number"},[n._v("78")]),a("br"),a("span",{staticClass:"line-number"},[n._v("79")]),a("br"),a("span",{staticClass:"line-number"},[n._v("80")]),a("br"),a("span",{staticClass:"line-number"},[n._v("81")]),a("br"),a("span",{staticClass:"line-number"},[n._v("82")]),a("br"),a("span",{staticClass:"line-number"},[n._v("83")]),a("br"),a("span",{staticClass:"line-number"},[n._v("84")]),a("br"),a("span",{staticClass:"line-number"},[n._v("85")]),a("br"),a("span",{staticClass:"line-number"},[n._v("86")]),a("br"),a("span",{staticClass:"line-number"},[n._v("87")]),a("br"),a("span",{staticClass:"line-number"},[n._v("88")]),a("br"),a("span",{staticClass:"line-number"},[n._v("89")]),a("br"),a("span",{staticClass:"line-number"},[n._v("90")]),a("br"),a("span",{staticClass:"line-number"},[n._v("91")]),a("br"),a("span",{staticClass:"line-number"},[n._v("92")]),a("br"),a("span",{staticClass:"line-number"},[n._v("93")]),a("br"),a("span",{staticClass:"line-number"},[n._v("94")]),a("br"),a("span",{staticClass:"line-number"},[n._v("95")]),a("br"),a("span",{staticClass:"line-number"},[n._v("96")]),a("br"),a("span",{staticClass:"line-number"},[n._v("97")]),a("br"),a("span",{staticClass:"line-number"},[n._v("98")]),a("br"),a("span",{staticClass:"line-number"},[n._v("99")]),a("br"),a("span",{staticClass:"line-number"},[n._v("100")]),a("br"),a("span",{staticClass:"line-number"},[n._v("101")]),a("br"),a("span",{staticClass:"line-number"},[n._v("102")]),a("br"),a("span",{staticClass:"line-number"},[n._v("103")]),a("br"),a("span",{staticClass:"line-number"},[n._v("104")]),a("br"),a("span",{staticClass:"line-number"},[n._v("105")]),a("br"),a("span",{staticClass:"line-number"},[n._v("106")]),a("br"),a("span",{staticClass:"line-number"},[n._v("107")]),a("br"),a("span",{staticClass:"line-number"},[n._v("108")]),a("br"),a("span",{staticClass:"line-number"},[n._v("109")]),a("br"),a("span",{staticClass:"line-number"},[n._v("110")]),a("br"),a("span",{staticClass:"line-number"},[n._v("111")]),a("br"),a("span",{staticClass:"line-number"},[n._v("112")]),a("br"),a("span",{staticClass:"line-number"},[n._v("113")]),a("br"),a("span",{staticClass:"line-number"},[n._v("114")]),a("br"),a("span",{staticClass:"line-number"},[n._v("115")]),a("br"),a("span",{staticClass:"line-number"},[n._v("116")]),a("br"),a("span",{staticClass:"line-number"},[n._v("117")]),a("br"),a("span",{staticClass:"line-number"},[n._v("118")]),a("br"),a("span",{staticClass:"line-number"},[n._v("119")]),a("br"),a("span",{staticClass:"line-number"},[n._v("120")]),a("br"),a("span",{staticClass:"line-number"},[n._v("121")]),a("br"),a("span",{staticClass:"line-number"},[n._v("122")]),a("br"),a("span",{staticClass:"line-number"},[n._v("123")]),a("br"),a("span",{staticClass:"line-number"},[n._v("124")]),a("br"),a("span",{staticClass:"line-number"},[n._v("125")]),a("br"),a("span",{staticClass:"line-number"},[n._v("126")]),a("br"),a("span",{staticClass:"line-number"},[n._v("127")]),a("br"),a("span",{staticClass:"line-number"},[n._v("128")]),a("br"),a("span",{staticClass:"line-number"},[n._v("129")]),a("br"),a("span",{staticClass:"line-number"},[n._v("130")]),a("br"),a("span",{staticClass:"line-number"},[n._v("131")]),a("br"),a("span",{staticClass:"line-number"},[n._v("132")]),a("br"),a("span",{staticClass:"line-number"},[n._v("133")]),a("br"),a("span",{staticClass:"line-number"},[n._v("134")]),a("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);